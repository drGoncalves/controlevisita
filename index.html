<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enviar Dados</title>
</head>
<body>
<h1>Enviar Dados para Google Sheets</h1>

<form id="form">
  <input type="text" id="nome" placeholder="Nome" required><br><br>
  <input type="text" id="cliente" placeholder="Cliente" required><br><br>
  <button type="submit">Enviar Localização</button>
</form>

<p id="status"></p>

<script>
const url = "https://script.google.com/macros/s/AKfycbzinOqCVG_QfCC3AEaxjR9-5NjIiv1pXd9uY4Sv4tG5cIGrxJ16OQuqNH7esub5wL2N/exec";

document.getElementById('form').addEventListener('submit', function(e) {
  e.preventDefault();
  const nome = document.getElementById('nome').value;
  const cliente = document.getElementById('cliente').value;

  if (!navigator.geolocation) {
    document.getElementById('status').innerText = "Geolocalização não suportada.";
    return;
  }

  navigator.geolocation.getCurrentPosition((pos) => {
    const data = {
      nome,
      cliente,
      latitude: pos.coords.latitude,
      longitude: pos.coords.longitude
    };

    fetch(url, {
      method: "POST",
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(res => {
      document.getElementById('status').innerText = res.status === "sucesso" ? "Enviado com sucesso!" : "Erro: " + res.message;
    })
    .catch(err => document.getElementById('status').innerText = "Erro ao enviar: " + err);
  }, (err) => {
    document.getElementById('status').innerText = "Erro ao obter localização: " + err.message;
  });
});
</script>
</body>
</html>
